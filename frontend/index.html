<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Script Generator</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #ffe4e6; /* Soft pink background */
            color: #4a4a4a; /* Neutral text color */
        }
        h1 {
            color: #d63384; /* Deep pink for headings */
        }
        #result {
            background-color: #fff; /* White background for result section */
            border: 2px solid #d63384; /* Pink border for result */
        }
        button {
            background-color: #d63384; /* Pink button */
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #e056a4; /* Slightly darker pink on hover */
        }
        .section-heading {
            font-size: 1.25rem;
            font-weight: bold;
            color: #d63384; /* Deep pink for section headings */
            margin-top: 1.5rem;
        }
        .section-content {
            padding-left: 1.5rem;
            font-size: 1rem;
            color: #333;
            line-height: 1.5;
        }
    </style>
</head>
<body class="bg-pink-100 text-gray-900">
    <div class="container mx-auto py-8">
        <h1 class="text-3xl font-bold mb-4 text-center">AI-Powered Video Script Generator</h1>
        <form id="scriptForm" class="space-y-4 bg-white p-6 rounded shadow">
            <textarea 
                id="prompt" 
                class="w-full border-2 border-pink-300 p-4 rounded focus:outline-none focus:ring focus:border-pink-500" 
                placeholder="Enter your prompt here"></textarea>
            <input 
                type="file" 
                id="files" 
                multiple 
                class="border-2 border-pink-300 p-4 rounded focus:outline-none focus:ring focus:border-pink-500"
            >
            <button 
                type="submit" 
                class="text-white px-6 py-3 rounded shadow-lg hover:shadow-xl"
            >
                Generate Script
            </button>
        </form>

        <div id="result" class="mt-8 p-6 rounded shadow hidden">
            <h2 class="text-2xl font-semibold mb-4 text-center">Generated Script:</h2>
            <div id="output" class="bg-pink-50 p-6 rounded text-gray-800"></div>
        </div>
    </div>
    <script>
        const form = document.getElementById('scriptForm');
        const resultDiv = document.getElementById('result');
        const output = document.getElementById('output');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const prompt = document.getElementById('prompt').value;
            const files = document.getElementById('files').files;

            const formData = new FormData();
            formData.append('prompt', prompt);
            for (let file of files) {
                formData.append('files', file);
            }

            try {
                const response = await fetch('http://127.0.0.1:8000/api/generate-script/', {
                    method: 'POST',
                    body: formData,
                });

                if (response.ok) {
                    const data = await response.json();
                    const script = data.choices[0].message.content.split("\n").filter(line => line.trim()); // Split into lines and remove empty ones
                    
                    // Display formatted sections
                    output.innerHTML = ""; // Clear existing content
                    
                    let sectionCounter = 1; // For better structure

                    script.forEach((line, index) => {
                        if (line.toLowerCase().includes("morning")) {
                            output.innerHTML += `<div class="section-heading">Morning</div><div class="section-content">${line}</div>`;
                        } else if (line.toLowerCase().includes("afternoon")) {
                            output.innerHTML += `<div class="section-heading">Afternoon</div><div class="section-content">${line}</div>`;
                        } else if (line.toLowerCase().includes("evening")) {
                            output.innerHTML += `<div class="section-heading">Evening</div><div class="section-content">${line}</div>`;
                        } else {
                            // If it's a regular point, categorize under a generic section
                            output.innerHTML += `<div class="section-heading">Part ${sectionCounter}</div><div class="section-content">${line}</div>`;
                            sectionCounter++;
                        }
                    });
                    resultDiv.classList.remove("hidden");
                } else {
                    output.innerHTML = `<div class="text-red-500">Error: ${response.statusText}</div>`;
                    resultDiv.classList.remove("hidden");
                }
            } catch (error) {
                output.innerHTML = `<div class="text-red-500">An error occurred: ${error.message}</div>`;
                resultDiv.classList.remove("hidden");
            }
        });
    </script>
</body>
</html>
